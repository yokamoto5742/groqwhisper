# GroqWhisper Code Explanation

このアプリケーションのコードの主要なクラスと関数の概要を説明します。

## 主要なクラスと関数

### グローバル設定

- `config`: ConfigParserオブジェクトで、`config.ini`ファイルから設定を読み込みます。
- `load_replacements()`: `replacements.txt`から置換ルールを読み込みます。
- `replace_text()`: 指定されたルールに基づいてテキストを置換します。
- `paste_delay`: クリップボードへのコピー後、自動貼り付けまでの遅延時間（秒）を指定します。この設定により、システムがコピー操作を完了し、貼り付け先のアプリケーションが準備できる時間を確保します。

### AudioRecorder クラス

音声録音を管理するクラスです。

主要なメソッド：
- `__init__()`: 録音パラメータを初期化します。
- `start_recording()`: 録音を開始します。
- `stop_recording()`: 録音を停止し、録音されたフレームとサンプルレートを返します。
- `record()`: 実際の録音プロセスを実行します。

### 補助関数

- `save_audio()`: 録音されたフレームを一時的なWAVファイルとして保存します。
- `transcribe_audio()`: Groq APIを使用して音声ファイルをテキストに変換します。
- `copy_and_paste_transcription()`: 文字起こしされたテキストをクリップボードにコピーし、`paste_delay`で指定された遅延後に自動的に貼り付けます。この遅延により、異なるシステム環境や負荷状況でも確実に貼り付けが行われるようになります。

### AudioRecorderGUI クラス

アプリケーションのグラフィカルユーザーインターフェースを管理します。

主要なメソッド：
- `__init__()`: GUIコンポーネントを初期化し、キーボードイベントをバインドします。
- `toggle_recording()`: 録音の開始/停止を切り替えます。
- `start_recording()`: 録音を開始し、関連するタイマーをセットします。
- `stop_recording()`: 録音を停止し、音声処理を開始します。
- `process_audio()`: 録音された音声を処理し、文字起こしを行います。
- `append_transcription()`: 文字起こしされたテキストをGUIに追加します。
- `show_five_second_notification()`: 自動停止5秒前の通知を表示します。
- `auto_stop_recording()`: 設定された時間後に録音を自動停止します。

その他のユーティリティメソッド：
- `toggle_punctuation()`, `toggle_comma()`: 句読点の使用を切り替えます。
- `copy_to_clipboard()`, `clear_text()`: テキスト操作用のメソッドです。
- `close_application()`: アプリケーションを適切に終了します。

### main() 関数

アプリケーションのエントリーポイントです。Tkinterのrootウィンドウを作成し、AudioRecorderGUIインスタンスを初期化します。

## 主要な機能

1. 音声録音：PyAudioを使用して音声を録音します。
2. 音声認識：Groq APIを使用して音声をテキストに変換します。
3. テキスト処理：設定に基づいて句読点を調整し、指定されたルールで置換を行います。
4. クリップボード操作：文字起こしされたテキストを自動的にクリップボードにコピーし、`paste_delay`で指定された遅延後に貼り付けます。
5. GUI操作：録音の開始/停止、テキストの表示、各種設定の切り替えなどをGUIで制御します。
6. キーボードショートカット：グローバルホットキーを使用して主要な機能を制御します。

## 注意点

- 環境変数 `GROQ_API_KEY` が必要です。
- `config.ini` と `replacements.txt` ファイルが必要です。
- PyAudio、Groq、pyperclip、keyboard、pyautoguiなどの外部ライブラリに依存しています。
- `paste_delay`設定を調整することで、異なるシステム環境や負荷状況に対応できます。遅延が短すぎると貼り付けに失敗する可能性があり、長すぎるとユーザー体験が低下する可能性があります。

このアプリケーションは、音声入力を簡単にテキストに変換し、即座に利用可能にすることを目的としています。開発者は、各クラスと関数の役割を理解し、必要に応じて機能を拡張または修正することができます。`paste_delay`のような設定パラメータを適切に調整することで、アプリケーションのパフォーマンスと信頼性を向上させることができます。