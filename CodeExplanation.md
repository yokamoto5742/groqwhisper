# BarcodePDF Code Explanations

## 1. `Config` クラス
このクラスは設定ファイル（config.ini）を読み込み、アプリケーションの設定を管理します。

- `__init__`: コンストラクタ。設定ファイルを読み込み、各種設定値を属性として保存します。
- `save`: 現在の設定をconfig.iniファイルに保存します。

## 2. `setup_logger` 関数
ロギングの設定を行う関数です。日単位でログローテーションを行い、指定された日数分のログを保持します。

## 3. `extract_images_from_pdf` 関数
PDFファイルから画像を抽出する関数です。埋め込み画像とページ全体の画像の両方を抽出し、コントラストを強調して返します。

## 4. `read_barcode_from_pdf` 関数
PDFから抽出した画像からバーコードを読み取る関数です。複数の画像処理テクニックを使用してバーコードの検出を試みます。

## 5. `open_error_folder` 関数
エラーフォルダを開く関数です。OSに応じて適切な方法でフォルダを開きます。

## 6. `process_pdf` 関数
PDFファイルを処理する主要な関数です。バーコードの読み取り、ファイルの移動、エラー処理などを行います。

## 7. `PDFHandler` クラス
ファイルシステムの変更を監視するハンドラークラスです。

- `__init__`: コンストラクタ。必要な設定とコールバック関数を初期化します。
- `on_created`: 新しいPDFファイルが作成されたときに呼び出され、そのファイルを処理します。

## 8. `PDFProcessorApp` クラス
アプリケーションのメインクラスです。GUIの作成と管理、PDFの処理、設定の管理などを行います。

- `__init__`: コンストラクタ。GUIの初期化、ロガーの設定、既存PDFの処理、監視の開始を行います。
- `create_widgets`: GUIのウィジェットを作成します。
- `browse_directory`: ディレクトリ選択ダイアログを開き、選択されたディレクトリを更新します。
- `save_config`: 現在の設定を保存し、ロガーを更新します。
- `open_error_folder`: エラーフォルダを開くスタティックメソッドです。
- `process_existing_pdfs`: 監視フォルダ内の既存のPDFファイルを処理します。
- `start_watching`: フォルダの監視を開始します。
- `stop_watching`: フォルダの監視を停止します。
- `update_status`: ステータス表示とログを更新します。
- `quit_app`: 監視を停止し、アプリケーションを終了します。
- `on_closing`: ウィンドウが閉じられるときの処理を行います。

## メイン部分
`if __name__ == "__main__":` 以下の部分は、スクリプトが直接実行された場合にアプリケーションを起動します。

## 主な変更点
1. `Config` クラスに `log_retention_days` と `ui_width`, `ui_height` の設定が追加されました。
2. `setup_logger` 関数が追加され、ログの設定が改善されました。
3. `PDFProcessorApp` クラスに `open_error_folder` スタティックメソッドが追加されました。
4. GUI の作成と管理が大幅に改善され、より多くの設定オプションが追加されました。
5. エラー処理とログ記録が強化されました。
6. バージョン情報の表示が追加されました。